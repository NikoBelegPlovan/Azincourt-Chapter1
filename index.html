<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Lecture plein écran — YouTube</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  html, body { height: 100%; }
  body {
    margin: 0; background: #000; color: #fff;
    display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 20px;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  #startBtn {
    font-size: 1.25rem; padding: 0.8rem 1.4rem; border: 0; border-radius: 10px; cursor: pointer;
    background: #d11a2a; color: #fff;
  }
  #info { color: #bbb; font-size: .95rem; text-align: center; max-width: 90ch; }
  iframe { display: none; background:#000; width:100vw; height:100vh; border:0; }
</style>
</head>
<body>

<button id="startBtn">▶ Commencer l'histoire d'Azincourt </button>
<div id="info">Echap pour quitter</div>

<script>
  const YOUTUBE_URL = "https://www.youtube.com/watch?v=ZK40PfIeYII";

  function isYouTubeUrl(url) {
    return /youtube\.com|youtu\.be/.test(url);
  }

  function extractYouTubeId(url) {
    try {
      const u = new URL(url);
      if (u.hostname.includes('youtu.be')) return u.pathname.slice(1);
      if (u.pathname.startsWith('/embed/')) return u.pathname.split('/embed/')[1].split(/[?&]/)[0];
      const v = u.searchParams.get('v');
      return v || "";
    } catch {
      return "";
    }
  }

  async function enterFullscreen(el) {
    try {
      if (el.requestFullscreen) await el.requestFullscreen();
      else if (el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
      else if (el.msRequestFullscreen) await el.msRequestFullscreen();
    } catch (e) {
      console.warn("Fullscreen refusé:", e);
    }
  }

  document.getElementById('startBtn').addEventListener('click', async () => {
    if (!isYouTubeUrl(YOUTUBE_URL)) {
      alert("URL YouTube invalide.");
      return;
    }
    const id = extractYouTubeId(YOUTUBE_URL);
    if (!id) {
      alert("Impossible d'extraire l'ID YouTube. Vérifiez l'URL.");
      return;
    }
    const params = new URLSearchParams({
      autoplay: '1',
      rel: '0',
      modestbranding: '1',
      playsinline: '1',
      controls: '1'
    });
    const iframe = document.createElement('iframe');
    iframe.src = `https://www.youtube.com/embed/${id}?${params.toString()}`;
    iframe.allow = 'autoplay; fullscreen; picture-in-picture';
    iframe.allowFullscreen = true;
    document.body.appendChild(iframe);
    iframe.style.display = 'block';

    await enterFullscreen(iframe);
    // Pas besoin d'appeler play(): YouTube gère l'autoplay après le clic
  });
</script>

</body>
</html>
